!function(e){function __webpack_require__(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,__webpack_require__),s.l=!0,s.exports}var t={};__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function decode(e){var t=e.match(/\[.*\]/);if(t){var n=JSON.parse(t[0]);return{type:n[0],data:n[1]}}return null}var s=n(2),o=function(e){return e&&e.__esModule?e:{default:e}}(s);new Vue({el:"#app",data:{name:"",socket:null,messages:[],msg:""},mounted:function(){var e=this;this.name=prompt("Type your nickname")||"Anonymous",this.socket=new o.default("wss://socketio-chat.now.sh/socket.io/?EIO=3&transport=websocket"),this.socket.send('42["add user","'+this.name+'"]'),this.socket.addEventListener("open",function(t){var n=t.reconnectCount;e.messages.push({type:"system",message:"socket open, reconnectCount: "+n})}),this.socket.addEventListener("close",function(t){var n=t.reconnectCount;e.messages.push({type:"system",message:"socket close, reconnectCount: "+n})}),this.socket.addEventListener("error",function(){e.messages.push({type:"system",message:"socket error"})}),this.socket.addEventListener("message",function(t){var n=t.data,s=decode(n);if(s)switch(s.type){case"new message":case"login":case"user joined":case"user left":e.messages.push(s),e.$nextTick(function(){e.$refs.content.scrollTop=e.$refs.content.scrollHeight})}})},methods:{sendMsg:function(){var e=this;""!==this.msg&&(this.socket.send('42["new message","'+this.msg+'"]'),this.messages.push({type:"new message",data:{username:this.name,message:this.msg}}),this.$nextTick(function(){e.$refs.content.scrollTop=e.$refs.content.scrollHeight}),this.msg="")}}})},function(e,t,n){"use strict";function createEvent(e,t){var n=new CustomEvent(e);return Object.assign(n,t),n}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t){var n=this;void 0===t&&(t={});var s=t.autoOpen;void 0===s&&(s=!0);var o=t.smartSend;void 0===o&&(o=!0);var c=t.autoReconnect;void 0===c&&(c=!0);var r=t.reconnectDelay;void 0===r&&(r=500);var i=t.maxReconnectCount;void 0===i&&(i=3),this._url=e,this._autoOpen=s,this._smartSend=o,this._autoReconnect=c,this._reconnectDelay=r,this._maxReconnectCount=i,this._reconnectCount=0,this._forceClose=!1,this._bus=document.createElement("div"),this.socket=null,this.addEventListener=this._bus.addEventListener.bind(this._bus),this.removeEventListener=this._bus.removeEventListener.bind(this._bus);var a=function(){n._forceClose?(n._forceClose=!1,n._reconnectCount=0):(n._reconnectCount+=1,n._reconnectCount>n._maxReconnectCount?(n._bus.dispatchEvent(createEvent("reconnectStopped",{reconnectCount:n._reconnectCount})),n._reconnectCount=0):setTimeout(function(){n.open()},n._reconnectDelay))};this._autoReconnect&&this.addEventListener("close",a),this._autoOpen&&this.open()};s.prototype.open=function(){var e=this;this.socket&&1===this.socket.readyState||(this.socket=new WebSocket(this._url),this._bus.dispatchEvent(createEvent("connecting",{reconnectCount:this._reconnectCount})),this.socket.addEventListener("open",function(){e._bus.dispatchEvent(createEvent("open",{reconnectCount:e._reconnectCount})),e._reconnectCount=0}),this.socket.addEventListener("message",function(t){var n=t.data,s=t.origin,o=t.lastEventId,c=t.source,r=t.ports;e._bus.dispatchEvent(createEvent("message",{reconnectCount:e._reconnectCount,data:n,origin:s,lastEventId:o,source:c,ports:r}))}),this.socket.addEventListener("close",function(t){var n=t.code,s=t.reason,o=t.wasClean;e._bus.dispatchEvent(createEvent("close",{reconnectCount:e._reconnectCount,code:n,reason:s,wasClean:o}))}),this.socket.addEventListener("error",function(){e._bus.dispatchEvent(createEvent("error",{reconnectCount:e._reconnectCount}))}))},s.prototype.close=function(){this.socket&&(this._forceClose=!0,this.socket.close())},s.prototype.send=function(e){var t=this;!this.socket||0===this.socket.readyState&&this._smartSend?this.addEventListener("open",function(){t.socket.send(e)},{once:!0}):this.socket.send(e)},t.default=s}]);